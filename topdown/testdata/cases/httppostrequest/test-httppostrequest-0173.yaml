cases:
- data: {}
  modules:
  - |
    package generated

    clean_headers(__local0__) = cleaned {
      json.remove(__local0__, ["headers/date"], __local3__)
      cleaned = __local3__
    }

    remove_headers(__local1__) = no_headers {
      object.remove(__local1__, ["headers"], __local4__)
      no_headers = __local4__
    }

    p = __local2__ {
      http.send({"body": {"foo": 1}, "headers": {"content-type": "application/x-www-form-encoded"}, "method": "post", "raw_body": "username=foobar&password=baz", "url": "http://127.0.0.1:38847"}, resp)
      data.generated.clean_headers(resp, __local5__)
      __local2__ = __local5__
    }
  note: httppostrequest/raw_body overrides body
  query: data.generated.p = x
  want_result:
  - x:
      body: null
      headers:
        content-length:
        - "28"
        content-type:
        - application/x-www-form-encoded
      raw_body: username=foobar&password=baz
      status: 200 OK
      status_code: 200
