---
cases:
  - data:
    modules:
      - |
        package generated

        p = [x, y, z] if {
          io.jwt.decode_verify(
            "eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.JkKWCY39IdWEQttmdqR7VdsvT-_QxheW_eb0S5wr_j83ltux_JDUIXs7a3Dtn3xuqzuhetiuJrWIvy5TzimeCg", 
            {"cert": "-----BEGIN PUBLIC KEY-----\nMCowBQYDK2VwAyEAwmK6SSAu2E9V7uynkCKEaj5nZJyTvNG4x0KohsRzLpg=\n-----END PUBLIC KEY-----\n"}, 
            [x, y, z])
        }
    note: jwtdecodeverify/EdDSA
    query: data.generated.p = x
    want_result:
      - x:
          - true
          - alg: EdDSA
            typ: JWT
          - admin: true
            iat: 1516239022
            name: John Doe
            sub: "1234567890"
