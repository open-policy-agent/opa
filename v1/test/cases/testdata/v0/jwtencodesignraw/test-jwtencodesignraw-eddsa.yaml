---
cases:
  - note: jwtencodesignraw/EdDSA
    query: data.test.p = x
    modules:
      - |
        package test
        p := x {
        	io.jwt.encode_sign_raw(
        		`{"alg":"EdDSA","typ":"JWT"}`,
        		`{"iss":"joe","exp":1300819380,"http://example.com/is_root":true}`,
        		`{"kty":"OKP","alg":"EdDSA","crv":"Ed25519","x":"wEZFfoAj1rFKTLOOmjJjVZlCHwksuvMb2I5y_hg70E8","d":"9XI34uQzYUJfWhDZf_0nYsLMBRVu8a6dFsy60P8uugk"}`,
        		x,
        	)
        }
    data: {}
    want_result:
      - x: eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJqb2UiLCJleHAiOjEzMDA4MTkzODAsImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ.jS1so-rsTaC8DdA8_ZnFXYbi9xOrMVXOviMFrahQ7ez0UKKzjU-2vxrM0ON-Vu3GXKhtBkkO3SUtNMoeYw3zDQ
