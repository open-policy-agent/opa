// Copyright 2024 The OPA Authors.  All rights reserved.
// Use of this source code is governed by an Apache2
// license that can be found in the LICENSE file.

package ast

import "strconv"

// NOTE! Great care must be taken **not** to modify the terms returned
// from these functions, as they are shared across all callers.

var (
	booleanTrueTerm  = &Term{Value: Boolean(true)}
	booleanFalseTerm = &Term{Value: Boolean(false)}

	// since this is by far the most common negative number
	minusOneTerm = &Term{Value: Number("-1")}
)

func InternedBooleanTerm(b bool) *Term {
	if b {
		return booleanTrueTerm
	}

	return booleanFalseTerm
}

// InternedIntNumberTerm returns a term with the given integer value. The term is
// cached between -1 to 512, and for values outside of that range, this function
// is equivalent to ast.IntNumberTerm.
func InternedIntNumberTerm(i int) *Term {
	if i >= 0 && i < len(intNumberTerms) {
		return intNumberTerms[i]
	}

	if i == -1 {
		return minusOneTerm
	}

	return &Term{Value: Number(strconv.Itoa(i))}
}

func HasInternedIntNumberTerm(i int) bool {
	return i >= -1 && i < len(intNumberTerms)
}

var intNumberTerms = [...]*Term{
	{Value: Number("0")},
	{Value: Number("1")},
	{Value: Number("2")},
	{Value: Number("3")},
	{Value: Number("4")},
	{Value: Number("5")},
	{Value: Number("6")},
	{Value: Number("7")},
	{Value: Number("8")},
	{Value: Number("9")},
	{Value: Number("10")},
	{Value: Number("11")},
	{Value: Number("12")},
	{Value: Number("13")},
	{Value: Number("14")},
	{Value: Number("15")},
	{Value: Number("16")},
	{Value: Number("17")},
	{Value: Number("18")},
	{Value: Number("19")},
	{Value: Number("20")},
	{Value: Number("21")},
	{Value: Number("22")},
	{Value: Number("23")},
	{Value: Number("24")},
	{Value: Number("25")},
	{Value: Number("26")},
	{Value: Number("27")},
	{Value: Number("28")},
	{Value: Number("29")},
	{Value: Number("30")},
	{Value: Number("31")},
	{Value: Number("32")},
	{Value: Number("33")},
	{Value: Number("34")},
	{Value: Number("35")},
	{Value: Number("36")},
	{Value: Number("37")},
	{Value: Number("38")},
	{Value: Number("39")},
	{Value: Number("40")},
	{Value: Number("41")},
	{Value: Number("42")},
	{Value: Number("43")},
	{Value: Number("44")},
	{Value: Number("45")},
	{Value: Number("46")},
	{Value: Number("47")},
	{Value: Number("48")},
	{Value: Number("49")},
	{Value: Number("50")},
	{Value: Number("51")},
	{Value: Number("52")},
	{Value: Number("53")},
	{Value: Number("54")},
	{Value: Number("55")},
	{Value: Number("56")},
	{Value: Number("57")},
	{Value: Number("58")},
	{Value: Number("59")},
	{Value: Number("60")},
	{Value: Number("61")},
	{Value: Number("62")},
	{Value: Number("63")},
	{Value: Number("64")},
	{Value: Number("65")},
	{Value: Number("66")},
	{Value: Number("67")},
	{Value: Number("68")},
	{Value: Number("69")},
	{Value: Number("70")},
	{Value: Number("71")},
	{Value: Number("72")},
	{Value: Number("73")},
	{Value: Number("74")},
	{Value: Number("75")},
	{Value: Number("76")},
	{Value: Number("77")},
	{Value: Number("78")},
	{Value: Number("79")},
	{Value: Number("80")},
	{Value: Number("81")},
	{Value: Number("82")},
	{Value: Number("83")},
	{Value: Number("84")},
	{Value: Number("85")},
	{Value: Number("86")},
	{Value: Number("87")},
	{Value: Number("88")},
	{Value: Number("89")},
	{Value: Number("90")},
	{Value: Number("91")},
	{Value: Number("92")},
	{Value: Number("93")},
	{Value: Number("94")},
	{Value: Number("95")},
	{Value: Number("96")},
	{Value: Number("97")},
	{Value: Number("98")},
	{Value: Number("99")},
	{Value: Number("100")},
	{Value: Number("101")},
	{Value: Number("102")},
	{Value: Number("103")},
	{Value: Number("104")},
	{Value: Number("105")},
	{Value: Number("106")},
	{Value: Number("107")},
	{Value: Number("108")},
	{Value: Number("109")},
	{Value: Number("110")},
	{Value: Number("111")},
	{Value: Number("112")},
	{Value: Number("113")},
	{Value: Number("114")},
	{Value: Number("115")},
	{Value: Number("116")},
	{Value: Number("117")},
	{Value: Number("118")},
	{Value: Number("119")},
	{Value: Number("120")},
	{Value: Number("121")},
	{Value: Number("122")},
	{Value: Number("123")},
	{Value: Number("124")},
	{Value: Number("125")},
	{Value: Number("126")},
	{Value: Number("127")},
	{Value: Number("128")},
	{Value: Number("129")},
	{Value: Number("130")},
	{Value: Number("131")},
	{Value: Number("132")},
	{Value: Number("133")},
	{Value: Number("134")},
	{Value: Number("135")},
	{Value: Number("136")},
	{Value: Number("137")},
	{Value: Number("138")},
	{Value: Number("139")},
	{Value: Number("140")},
	{Value: Number("141")},
	{Value: Number("142")},
	{Value: Number("143")},
	{Value: Number("144")},
	{Value: Number("145")},
	{Value: Number("146")},
	{Value: Number("147")},
	{Value: Number("148")},
	{Value: Number("149")},
	{Value: Number("150")},
	{Value: Number("151")},
	{Value: Number("152")},
	{Value: Number("153")},
	{Value: Number("154")},
	{Value: Number("155")},
	{Value: Number("156")},
	{Value: Number("157")},
	{Value: Number("158")},
	{Value: Number("159")},
	{Value: Number("160")},
	{Value: Number("161")},
	{Value: Number("162")},
	{Value: Number("163")},
	{Value: Number("164")},
	{Value: Number("165")},
	{Value: Number("166")},
	{Value: Number("167")},
	{Value: Number("168")},
	{Value: Number("169")},
	{Value: Number("170")},
	{Value: Number("171")},
	{Value: Number("172")},
	{Value: Number("173")},
	{Value: Number("174")},
	{Value: Number("175")},
	{Value: Number("176")},
	{Value: Number("177")},
	{Value: Number("178")},
	{Value: Number("179")},
	{Value: Number("180")},
	{Value: Number("181")},
	{Value: Number("182")},
	{Value: Number("183")},
	{Value: Number("184")},
	{Value: Number("185")},
	{Value: Number("186")},
	{Value: Number("187")},
	{Value: Number("188")},
	{Value: Number("189")},
	{Value: Number("190")},
	{Value: Number("191")},
	{Value: Number("192")},
	{Value: Number("193")},
	{Value: Number("194")},
	{Value: Number("195")},
	{Value: Number("196")},
	{Value: Number("197")},
	{Value: Number("198")},
	{Value: Number("199")},
	{Value: Number("200")},
	{Value: Number("201")},
	{Value: Number("202")},
	{Value: Number("203")},
	{Value: Number("204")},
	{Value: Number("205")},
	{Value: Number("206")},
	{Value: Number("207")},
	{Value: Number("208")},
	{Value: Number("209")},
	{Value: Number("210")},
	{Value: Number("211")},
	{Value: Number("212")},
	{Value: Number("213")},
	{Value: Number("214")},
	{Value: Number("215")},
	{Value: Number("216")},
	{Value: Number("217")},
	{Value: Number("218")},
	{Value: Number("219")},
	{Value: Number("220")},
	{Value: Number("221")},
	{Value: Number("222")},
	{Value: Number("223")},
	{Value: Number("224")},
	{Value: Number("225")},
	{Value: Number("226")},
	{Value: Number("227")},
	{Value: Number("228")},
	{Value: Number("229")},
	{Value: Number("230")},
	{Value: Number("231")},
	{Value: Number("232")},
	{Value: Number("233")},
	{Value: Number("234")},
	{Value: Number("235")},
	{Value: Number("236")},
	{Value: Number("237")},
	{Value: Number("238")},
	{Value: Number("239")},
	{Value: Number("240")},
	{Value: Number("241")},
	{Value: Number("242")},
	{Value: Number("243")},
	{Value: Number("244")},
	{Value: Number("245")},
	{Value: Number("246")},
	{Value: Number("247")},
	{Value: Number("248")},
	{Value: Number("249")},
	{Value: Number("250")},
	{Value: Number("251")},
	{Value: Number("252")},
	{Value: Number("253")},
	{Value: Number("254")},
	{Value: Number("255")},
	{Value: Number("256")},
	{Value: Number("257")},
	{Value: Number("258")},
	{Value: Number("259")},
	{Value: Number("260")},
	{Value: Number("261")},
	{Value: Number("262")},
	{Value: Number("263")},
	{Value: Number("264")},
	{Value: Number("265")},
	{Value: Number("266")},
	{Value: Number("267")},
	{Value: Number("268")},
	{Value: Number("269")},
	{Value: Number("270")},
	{Value: Number("271")},
	{Value: Number("272")},
	{Value: Number("273")},
	{Value: Number("274")},
	{Value: Number("275")},
	{Value: Number("276")},
	{Value: Number("277")},
	{Value: Number("278")},
	{Value: Number("279")},
	{Value: Number("280")},
	{Value: Number("281")},
	{Value: Number("282")},
	{Value: Number("283")},
	{Value: Number("284")},
	{Value: Number("285")},
	{Value: Number("286")},
	{Value: Number("287")},
	{Value: Number("288")},
	{Value: Number("289")},
	{Value: Number("290")},
	{Value: Number("291")},
	{Value: Number("292")},
	{Value: Number("293")},
	{Value: Number("294")},
	{Value: Number("295")},
	{Value: Number("296")},
	{Value: Number("297")},
	{Value: Number("298")},
	{Value: Number("299")},
	{Value: Number("300")},
	{Value: Number("301")},
	{Value: Number("302")},
	{Value: Number("303")},
	{Value: Number("304")},
	{Value: Number("305")},
	{Value: Number("306")},
	{Value: Number("307")},
	{Value: Number("308")},
	{Value: Number("309")},
	{Value: Number("310")},
	{Value: Number("311")},
	{Value: Number("312")},
	{Value: Number("313")},
	{Value: Number("314")},
	{Value: Number("315")},
	{Value: Number("316")},
	{Value: Number("317")},
	{Value: Number("318")},
	{Value: Number("319")},
	{Value: Number("320")},
	{Value: Number("321")},
	{Value: Number("322")},
	{Value: Number("323")},
	{Value: Number("324")},
	{Value: Number("325")},
	{Value: Number("326")},
	{Value: Number("327")},
	{Value: Number("328")},
	{Value: Number("329")},
	{Value: Number("330")},
	{Value: Number("331")},
	{Value: Number("332")},
	{Value: Number("333")},
	{Value: Number("334")},
	{Value: Number("335")},
	{Value: Number("336")},
	{Value: Number("337")},
	{Value: Number("338")},
	{Value: Number("339")},
	{Value: Number("340")},
	{Value: Number("341")},
	{Value: Number("342")},
	{Value: Number("343")},
	{Value: Number("344")},
	{Value: Number("345")},
	{Value: Number("346")},
	{Value: Number("347")},
	{Value: Number("348")},
	{Value: Number("349")},
	{Value: Number("350")},
	{Value: Number("351")},
	{Value: Number("352")},
	{Value: Number("353")},
	{Value: Number("354")},
	{Value: Number("355")},
	{Value: Number("356")},
	{Value: Number("357")},
	{Value: Number("358")},
	{Value: Number("359")},
	{Value: Number("360")},
	{Value: Number("361")},
	{Value: Number("362")},
	{Value: Number("363")},
	{Value: Number("364")},
	{Value: Number("365")},
	{Value: Number("366")},
	{Value: Number("367")},
	{Value: Number("368")},
	{Value: Number("369")},
	{Value: Number("370")},
	{Value: Number("371")},
	{Value: Number("372")},
	{Value: Number("373")},
	{Value: Number("374")},
	{Value: Number("375")},
	{Value: Number("376")},
	{Value: Number("377")},
	{Value: Number("378")},
	{Value: Number("379")},
	{Value: Number("380")},
	{Value: Number("381")},
	{Value: Number("382")},
	{Value: Number("383")},
	{Value: Number("384")},
	{Value: Number("385")},
	{Value: Number("386")},
	{Value: Number("387")},
	{Value: Number("388")},
	{Value: Number("389")},
	{Value: Number("390")},
	{Value: Number("391")},
	{Value: Number("392")},
	{Value: Number("393")},
	{Value: Number("394")},
	{Value: Number("395")},
	{Value: Number("396")},
	{Value: Number("397")},
	{Value: Number("398")},
	{Value: Number("399")},
	{Value: Number("400")},
	{Value: Number("401")},
	{Value: Number("402")},
	{Value: Number("403")},
	{Value: Number("404")},
	{Value: Number("405")},
	{Value: Number("406")},
	{Value: Number("407")},
	{Value: Number("408")},
	{Value: Number("409")},
	{Value: Number("410")},
	{Value: Number("411")},
	{Value: Number("412")},
	{Value: Number("413")},
	{Value: Number("414")},
	{Value: Number("415")},
	{Value: Number("416")},
	{Value: Number("417")},
	{Value: Number("418")},
	{Value: Number("419")},
	{Value: Number("420")},
	{Value: Number("421")},
	{Value: Number("422")},
	{Value: Number("423")},
	{Value: Number("424")},
	{Value: Number("425")},
	{Value: Number("426")},
	{Value: Number("427")},
	{Value: Number("428")},
	{Value: Number("429")},
	{Value: Number("430")},
	{Value: Number("431")},
	{Value: Number("432")},
	{Value: Number("433")},
	{Value: Number("434")},
	{Value: Number("435")},
	{Value: Number("436")},
	{Value: Number("437")},
	{Value: Number("438")},
	{Value: Number("439")},
	{Value: Number("440")},
	{Value: Number("441")},
	{Value: Number("442")},
	{Value: Number("443")},
	{Value: Number("444")},
	{Value: Number("445")},
	{Value: Number("446")},
	{Value: Number("447")},
	{Value: Number("448")},
	{Value: Number("449")},
	{Value: Number("450")},
	{Value: Number("451")},
	{Value: Number("452")},
	{Value: Number("453")},
	{Value: Number("454")},
	{Value: Number("455")},
	{Value: Number("456")},
	{Value: Number("457")},
	{Value: Number("458")},
	{Value: Number("459")},
	{Value: Number("460")},
	{Value: Number("461")},
	{Value: Number("462")},
	{Value: Number("463")},
	{Value: Number("464")},
	{Value: Number("465")},
	{Value: Number("466")},
	{Value: Number("467")},
	{Value: Number("468")},
	{Value: Number("469")},
	{Value: Number("470")},
	{Value: Number("471")},
	{Value: Number("472")},
	{Value: Number("473")},
	{Value: Number("474")},
	{Value: Number("475")},
	{Value: Number("476")},
	{Value: Number("477")},
	{Value: Number("478")},
	{Value: Number("479")},
	{Value: Number("480")},
	{Value: Number("481")},
	{Value: Number("482")},
	{Value: Number("483")},
	{Value: Number("484")},
	{Value: Number("485")},
	{Value: Number("486")},
	{Value: Number("487")},
	{Value: Number("488")},
	{Value: Number("489")},
	{Value: Number("490")},
	{Value: Number("491")},
	{Value: Number("492")},
	{Value: Number("493")},
	{Value: Number("494")},
	{Value: Number("495")},
	{Value: Number("496")},
	{Value: Number("497")},
	{Value: Number("498")},
	{Value: Number("499")},
	{Value: Number("500")},
	{Value: Number("501")},
	{Value: Number("502")},
	{Value: Number("503")},
	{Value: Number("504")},
	{Value: Number("505")},
	{Value: Number("506")},
	{Value: Number("507")},
	{Value: Number("508")},
	{Value: Number("509")},
	{Value: Number("510")},
	{Value: Number("511")},
	{Value: Number("512")},
}
